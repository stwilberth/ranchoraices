---
import Layout from '../../components/Layout.astro';
import Gallery from '../../components/Gallery.jsx';
import { languages } from '../../i18n.js';
import { accommodations as rawAccommodations } from '../../data/accommodations.js';

export async function getStaticPaths() {
  return rawAccommodations.map(acc => ({
    params: { slug: acc.slug }
  }));
}

const lang = 'es';
const t = languages[lang];

const accommodations = rawAccommodations.map(acc => ({
  ...acc,
  description: acc.description[lang],
  amenities: acc.amenities[lang],
  imageSrcs: acc.images.map(img => img.src),
  nearbyAttractions: acc.nearbyAttractions[lang]
}));

const { slug } = Astro.params;
const accommodation = accommodations.find(acc => acc.slug === slug);

if (!accommodation) {
  throw new Error(`Accommodation with slug "${slug}" not found`);
}

const getAmenityIcon = (amenity) => {
  const iconMap = {
    'WiFi gratis': 'fas fa-wifi',
    'Parking privado gratuito': 'fas fa-car',
    'Jardín': 'fas fa-leaf',
    'Terraza': 'fas fa-home',
    'Bar': 'fas fa-glass-martini',
    'Cocina equipada': 'fas fa-utensils',
    'Lavadora': 'fas fa-tshirt',
    'Admite mascotas': 'fas fa-paw',
    'Habitaciones familiares': 'fas fa-users',
    'Prohibido fumar': 'fas fa-smoking-ban',
    'Restaurante con comida típica': 'fas fa-utensils',
    'Cabinas cómodas y limpias': 'fas fa-bed',
    'Ambientes familiares': 'fas fa-home'
  };
  return iconMap[amenity] || 'fas fa-check';
};
---

<Layout url={Astro.url}>
  <section class="py-16 px-4 md:px-0 max-w-6xl mx-auto space-y-12">
    <!-- Hero Section -->
    <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-8 md:p-12 shadow-lg">
      <h1 class="font-display text-4xl md:text-6xl text-amber-900 mb-4">{accommodation.name}</h1>
      <div class="flex items-center text-lg text-gray-600 mb-6">
        <i class="fas fa-map-marker-alt text-amber-600 mr-2"></i>
        {accommodation.location}
      </div>
      <p class="text-gray-700 text-lg leading-relaxed">{accommodation.description}</p>
    </div>

    <!-- Gallery -->
    <div class="bg-white rounded-2xl p-8 shadow-lg">
      <h2 class="font-display text-3xl text-amber-900 mb-6">Galería</h2>
      <Gallery images={accommodation.imageSrcs} client:load />
    </div>

    <!-- Amenities -->
    <div class="bg-white rounded-2xl p-8 shadow-lg">
      <h2 class="font-display text-3xl text-amber-900 mb-6">Servicios</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {accommodation.amenities.map((amenity) => (
          <div class="flex items-center p-4 bg-gray-50 rounded-xl hover:bg-amber-50 transition-colors">
            <i class={`${getAmenityIcon(amenity)} text-amber-600 text-xl mr-3`}></i>
            <span class="text-gray-700 font-medium">{amenity}</span>
          </div>
        ))}
      </div>
    </div>

    <!-- Room Details -->
    <div class="bg-white rounded-2xl p-8 shadow-lg">
      <h2 class="font-display text-3xl text-amber-900 mb-6">Detalles de la Habitación</h2>
      <div class="space-y-4">
        <div class="flex items-center text-gray-700">
          <i class="fas fa-home text-amber-600 text-xl mr-3"></i>
          <span class="font-medium">Tipo:</span>
          <span class="ml-2">{accommodation.roomDetails.type}</span>
        </div>
        <div>
          <h3 class="font-semibold text-gray-800 mb-3">Dormitorios:</h3>
          <div class="space-y-2">
            {accommodation.roomDetails.bedrooms.map((bedroom, index) => (
              <div key={index} class="flex items-center text-gray-700 bg-gray-50 p-3 rounded-lg">
                <i class="fas fa-bed text-amber-600 mr-3"></i>
                <span>{bedroom.name}: {bedroom.beds}</span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>

    <!-- Nearby Attractions -->
    <div class="bg-white rounded-2xl p-8 shadow-lg">
      <h2 class="font-display text-3xl text-amber-900 mb-6">Atracciones Cercanas</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {accommodation.nearbyAttractions.map((attraction, index) => (
          <div key={index} class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
            <div class="flex items-center">
              <i class="fas fa-map-marker-alt text-amber-600 text-xl mr-3"></i>
              <span class="font-medium text-gray-800">{attraction.name}</span>
            </div>
            <span class="text-gray-600 bg-white px-3 py-1 rounded-full text-sm font-medium">{attraction.distance}</span>
          </div>
        ))}
      </div>
    </div>

    <!-- Check-in/Check-out -->
    <div class="bg-white rounded-2xl p-6 shadow-lg">
      <h2 class="font-display text-2xl text-amber-900 mb-4">Horarios</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="text-center p-4 bg-green-50 rounded-lg">
          <i class="fas fa-sign-in-alt text-green-600 text-2xl mb-2"></i>
          <h3 class="font-semibold text-gray-800 mb-1 text-sm">Check-in</h3>
          <p class="text-xl font-bold text-green-600">{accommodation.checkInOut.checkIn}</p>
        </div>
        <div class="text-center p-4 bg-red-50 rounded-lg">
          <i class="fas fa-sign-out-alt text-red-600 text-2xl mb-2"></i>
          <h3 class="font-semibold text-gray-800 mb-1 text-sm">Check-out</h3>
          <p class="text-xl font-bold text-red-600">{accommodation.checkInOut.checkOut}</p>
        </div>
      </div>
    </div>

    <!-- Contact Buttons -->
    <div class="bg-white rounded-2xl p-8 shadow-lg">
      <h2 class="font-display text-3xl text-amber-900 mb-6">Contacto</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <!-- Website Button -->
        <a
          href={accommodation.website}
          target="_blank"
          rel="noopener noreferrer"
          class="group relative flex items-center justify-center px-6 py-4 bg-gradient-to-r from-amber-400 to-amber-300 text-amber-900 rounded-xl hover:from-amber-500 hover:to-amber-400 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1"
        >
          <div class="absolute left-4 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
            <i class="fas fa-globe text-amber-900 text-lg"></i>
          </div>
          <span class="font-semibold">Visitar Sitio Web</span>
          <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
        </a>

        <!-- Facebook Button -->
        <a
          href={accommodation.facebook}
          target="_blank"
          rel="noopener noreferrer"
          class="group relative flex items-center justify-center px-6 py-4 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1"
        >
          <div class="absolute left-4 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
            <i class="fab fa-facebook-f text-white text-lg"></i>
          </div>
          <span class="font-semibold">Facebook</span>
          <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
        </a>

        <!-- WhatsApp Button -->
        <a
          href={`https://wa.me/${accommodation.contact.phone}?text=Hola, me gustaría obtener más información sobre ${accommodation.name}`}
          target="_blank"
          rel="noopener noreferrer"
          class="group relative flex items-center justify-center px-6 py-4 bg-gradient-to-r from-green-500 to-green-400 text-white rounded-xl hover:from-green-600 hover:to-green-500 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1"
        >
          <div class="absolute left-4 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
            <i class="fab fa-whatsapp text-white text-xl"></i>
          </div>
          <span class="font-semibold">WhatsApp</span>
          <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
        </a>

        <!-- Email Button -->
        <a
          href={`mailto:${accommodation.contact.email}?subject=Consulta sobre ${accommodation.name}`}
          class="group relative flex items-center justify-center px-6 py-4 bg-gradient-to-r from-gray-700 to-gray-600 text-white rounded-xl hover:from-gray-800 hover:to-gray-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1"
        >
          <div class="absolute left-4 w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
            <i class="fas fa-envelope text-white text-lg"></i>
          </div>
          <span class="font-semibold">Enviar Email</span>
          <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
        </a>
      </div>
    </div>
  </section>