---
import { languages, getLangFromUrl } from '../i18n.js';
import '../styles/global.css';
import ScrollToTop from './ScrollToTop.astro';

const { url = new URL('http://localhost/') } = Astro.props;
const lang = getLangFromUrl(url);
const t = languages[lang];
const link_class = "hover:text-amber-400 transition";
---
<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{t.siteName}</title>
    <meta name="description" content={t.heroSubtitle} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>
  <body class="bg-amber-50 text-gray-900 min-h-screen flex flex-col">
    <header class="w-full py-4 px-6 flex items-center justify-between bg-amber-900 text-amber-50 shadow-md relative sticky top-0 z-50">
      <div class="text-2xl font-display tracking-wide">
        <a href={lang === 'es' ? '/' : '/en/'}>{t.siteName}</a>
      </div>
      
      <button id="menu-btn" class="md:hidden block text-amber-50 hover:text-amber-400 focus:outline-none z-50 transition-transform hover:scale-110" aria-label="Menu">
        <svg id="menu-icon" class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg id="close-icon" class="w-8 h-8 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Desktop Menu -->
      <nav class="hidden md:flex items-center gap-6 text-lg">
        <a href={lang === 'es' ? '/' : '/en/'} class={link_class}>{t.home}</a>
        <a href={lang === 'es' ? '/tours' : '/en/tours'} class={link_class}>{t.tours}</a>
        <a href={lang === 'es' ? '/restaurants' : '/en/restaurants'} class={link_class}>{t.restaurants}</a>
        <a href={lang === 'es' ? '/about' : '/en/about'} class={link_class}>{t.about}</a>
        <a href={lang === 'es' ? '/gallery' : '/en/gallery'} class={link_class}>{t.gallery}</a>
        <a href={lang === 'es' ? '/accommodations' : '/en/accommodations'} class={link_class}>{t.accommodations}</a>
        <a href={lang === 'es' ? '/contact' : '/en/contact'} class={link_class}>{t.contact}</a>
        <a href={lang === 'es' ? '/en' : '/'} class="ml-4 px-3 py-1 rounded bg-amber-400 text-amber-900 font-semibold hover:bg-green-600 hover:text-white transition">{t.switchLang}</a>
      </nav>
    </header>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="fixed inset-0 bg-black/30 backdrop-blur-sm z-40 opacity-0 pointer-events-none transition-opacity duration-300">
      <div class="fixed bottom-0 left-0 right-0 bg-amber-900/95 rounded-t-3xl p-6 transform translate-y-full transition-transform duration-300 ease-in-out">
        <div class="flex justify-end mb-4">
          <button id="close-menu-btn" class="text-amber-50 hover:text-amber-300 transition-colors p-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="flex flex-col items-center">
          <nav class="flex flex-col items-center space-y-6 w-full max-w-xs">
            <a href={lang === 'es' ? '/' : '/en/'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.home}</a>
            <a href={lang === 'es' ? '/tours' : '/en/tours'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.tours}</a>
            <a href={lang === 'es' ? '/restaurants' : '/en/restaurants'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.restaurants}</a>
            <a href={lang === 'es' ? '/about' : '/en/about'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.about}</a>
            <a href={lang === 'es' ? '/gallery' : '/en/gallery'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.gallery}</a>
            <a href={lang === 'es' ? '/accommodations' : '/en/accommodations'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.accommodations}</a>
            <a href={lang === 'es' ? '/contact' : '/en/contact'} class="text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">{t.contact}</a>
            <a href="https://wa.me/50686394010" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center text-2xl text-amber-50 hover:text-amber-300 transition-colors py-3 w-full text-center border-b border-amber-800">
              <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.5 14.4l-2.2-2.2c-.2-.2-.5-.2-.7 0l-1.6 1.6c-.5-.3-1.3-.6-1.9-.9-.3-.1-.5-.4-.4-.7.3-.8.5-1.7.5-2.7 0-3.1-2.5-5.6-5.6-5.6-.8 0-1.6.2-2.3.5-.3.1-.5.4-.4.7.3 1 .6 1.8 1 2.5.1.2.1.5 0 .7L3.5 9.9c-.2.2-.2.5 0 .7l2.8 2.8c.2.2.5.2.7 0l1.3-1.3c.2-.2.5-.2.7 0 .9.7 1.9 1.2 3 1.4.3 0 .5.3.4.6-.3 1.1-.8 2.1-1.4 2.9-.1.2-.1.5 0 .7l1.4 1.4c.2.2.5.2.7 0l2.8-2.8c.2-.2.5-.2.7 0l1.3 1.3c.2.2.5.2.7 0l2.8-2.8c.2-.2.2-.5 0-.7l-2.2-2.1z"/>
              </svg>
              +506 8639 4010
            </a>
            <a href={lang === 'es' ? '/en' : '/'} class="mt-4 px-6 py-3 rounded-full bg-amber-400 text-amber-900 font-bold text-lg hover:bg-green-600 hover:text-white transition-all transform hover:scale-105 w-full text-center">
              {t.switchLang}
            </a>
          </nav>
        </div>
      </div>
    </div>

    <main class="flex-1 flex flex-col">
      <slot />
    </main>
    <ScrollToTop />
    <footer class="w-full bg-[#381705] text-amber-50 py-6 px-6 mt-10">
      <div class="max-w-6xl mx-auto">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm">
          <div>© {new Date().getFullYear()} Rancho Raíces. {lang === 'es' ? 'Todos los derechos reservados.' : 'All rights reserved.'}</div>
          <div class="flex flex-col md:flex-row items-center gap-4">
            <div class="flex items-center">
              <i class="fas fa-envelope mr-2"></i>
              <span>info@ranchoraices.com</span>
            </div>
            <div class="flex items-center">
              <i class="fas fa-phone mr-2"></i>
              <a href="tel:+50686394010" class="hover:underline">+506 8639 4010</a>
              <span class="mx-2">|</span>
              <a href="https://wa.me/50686394010" target="_blank" rel="noopener noreferrer" class="flex items-center text-green-300 hover:text-green-100">
                <i class="fab fa-whatsapp text-2xl mr-2"></i>
                WhatsApp
              </a>
            </div>
          </div>
        </div>
        
        <!-- Redes Sociales -->
        <div class="mt-6 pt-6 border-t border-amber-800">
          <h3 class="text-lg font-display mb-4 text-center md:text-left">Síguenos en redes sociales</h3>
          <div class="flex justify-center md:justify-start gap-6">
            <a href="https://www.facebook.com/RanchoRaices" target="_blank" rel="noopener noreferrer" 
               class="text-amber-50 hover:text-blue-400 transition-colors" 
               aria-label="Facebook de Rancho Raíces">
              <i class="fab fa-facebook text-4xl"></i>
            </a>
            <a href="https://www.instagram.com/ranchoraices/" target="_blank" rel="noopener noreferrer" 
               class="text-amber-50 hover:text-pink-500 transition-colors" 
               aria-label="Instagram de Rancho Raíces">
              <i class="fab fa-instagram text-4xl"></i>
            </a>
            <a href="https://www.tripadvisor.es/Attraction_Review-g309284-d3174761-Reviews-Rancho_Raices_De_Puerto_Jimenez-Puerto_Jimenez_Osa_Peninsula_Province_of_Puntaren.html" 
               target="_blank" rel="noopener noreferrer" 
               class="text-amber-50 hover:text-green-500 transition-colors" 
               aria-label="TripAdvisor de Rancho Raíces">
              <svg fill="#ffffff" width="42px" height="42px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>tripadvisor</title> <path d="M23.49 14.862c0 0 0 0 0 0-1.469 0-2.659 1.191-2.659 2.659s1.191 2.659 2.659 2.659c1.469 0 2.659-1.191 2.659-2.659 0-0.49-0.132-0.948-0.363-1.342l0.007 0.013c-0.468-0.8-1.324-1.33-2.303-1.33 0 0 0 0 0 0v0zM8.505 14.862c0 0 0 0 0 0-1.469 0-2.659 1.191-2.659 2.659s1.191 2.659 2.659 2.659c1.469 0 2.659-1.191 2.659-2.659 0-0.49-0.132-0.948-0.363-1.342l0.007 0.013c-0.468-0.8-1.324-1.33-2.303-1.33v0zM23.49 12.45c0.001 0 0.001 0 0.002 0 2.8 0 5.070 2.27 5.070 5.070s-2.27 5.070-5.070 5.070c-2.8 0-5.070-2.27-5.070-5.070 0-0.933 0.252-1.807 0.691-2.558l-0.013 0.024c0.892-1.527 2.523-2.536 4.39-2.537h0zM8.505 12.447c0 0 0 0 0 0 2.801 0 5.072 2.271 5.072 5.072s-2.271 5.072-5.072 5.072c-2.801 0-5.072-2.271-5.072-5.072 0-0.934 0.252-1.809 0.692-2.56l-0.013 0.024c0.893-1.527 2.525-2.536 4.393-2.536v0zM16 8.821c2.032 0.001 3.966 0.416 5.724 1.165l-0.096-0.036c-3.173 1.090-5.447 3.97-5.628 7.405l-0.001 0.020c-0.18-3.455-2.455-6.336-5.57-7.408l-0.058-0.017c1.662-0.712 3.597-1.126 5.628-1.127h0zM16.008 6.372c-0.002 0-0.005 0-0.007 0-3.565 0-6.873 1.099-9.604 2.978l0.057-0.037h-5.45l2.453 2.668c-1.508 1.376-2.45 3.349-2.45 5.542 0 4.138 3.355 7.493 7.493 7.493 1.971 0 3.764-0.761 5.102-2.005l-0.005 0.004 2.402 2.614 2.402-2.612c1.333 1.239 3.126 2 5.097 2 4.139 0 7.494-3.355 7.494-7.494 0-2.193-0.942-4.167-2.444-5.537l-0.006-0.005 2.453-2.668h-5.436c-2.673-1.841-5.98-2.94-9.545-2.94-0.003 0-0.005 0-0.008 0h0z"></path> </g></svg>
            </a>
            <a href="https://maps.app.goo.gl/VsTUBsxhHF4poFcy7" 
               target="_blank" rel="noopener noreferrer" 
               class="text-amber-50 hover:text-red-500 transition-colors" 
               aria-label="Ubicación de Rancho Raíces en Google Maps">
              <i class="fas fa-map-marker-alt text-4xl"></i>
            </a>
          </div>
        </div>
        
        <div class="mt-6 text-center md:text-left text-sm">
          <p>Puerto Jiménez, Península de Osa, Costa Rica</p>
        </div>
    </footer>

    <script>
      const menuBtn = document.getElementById('menu-btn');
      const closeMenuBtn = document.getElementById('close-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      const mobileMenuContent = mobileMenu?.querySelector('div > div');
      const menuIcon = document.getElementById('menu-icon');
      const closeIcon = document.getElementById('close-icon');
      let isOpen = false;

      function openMenu() {
        if (!isOpen) {
          mobileMenu.classList.remove('opacity-0', 'pointer-events-none');
          mobileMenuContent.classList.remove('translate-y-full');
          document.body.style.overflow = 'hidden';
          menuIcon.classList.add('hidden');
          closeIcon.classList.remove('hidden');
          isOpen = true;
        }
      }

      function closeMenu() {
        if (isOpen) {
          mobileMenuContent.classList.add('translate-y-full');
          mobileMenu.classList.add('opacity-0', 'pointer-events-none');
          document.body.style.overflow = '';
          menuIcon.classList.remove('hidden');
          closeIcon.classList.add('hidden');
          isOpen = false;
        }
      }

      function toggleMenu() {
        if (isOpen) closeMenu();
        else openMenu();
      }

      // Event Listeners
      menuBtn?.addEventListener('click', toggleMenu);
      closeMenuBtn?.addEventListener('click', closeMenu);

      // Cerrar al hacer clic fuera del menú
      mobileMenu?.addEventListener('click', (e) => {
        if (e.target === mobileMenu) closeMenu();
      });

      // Cerrar menú al hacer clic en un enlace
      document.querySelectorAll('#mobile-menu nav a').forEach(link => {
        link.addEventListener('click', closeMenu);
      });

      // Cerrar con tecla Escape
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && isOpen) closeMenu();
      });
    </script>
  </body>
</html>